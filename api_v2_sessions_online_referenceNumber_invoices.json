//
// Endpoint: /api/v2/sessions/online/{referenceNumber}/invoices
//
// Generated by OpenAPI_JSON_To_Single_Endpoint app.
// Author: Grzegorz Molenda.
// v.2 - 2025, All rights reserved.
// Released under MIT License.
//
  "/api/v2/sessions/online/{referenceNumber}/invoices" : {
    "post" : {
      "tags" : [
        "Wysyłka interaktywna"
      ],
      "summary" : "Wysłanie faktury",
      "description" : "Przyjmuje zaszyfrowaną fakturę oraz jej metadane i rozpoczyna jej przetwarzanie.\n\n> Więcej informacji:\n> - [Wysłanie faktury](https://github.com/CIRFMF/ksef-docs/blob/main/sesja-interaktywna.md#2-wys%C5%82anie-faktury)\n\n**Wymagane uprawnienia**: `InvoiceWrite`, `PefInvoiceWrite`.",
      "parameters" : [
        {
          "name" : "referenceNumber",
          "in" : "path",
          "description" : "Numer referencyjny sesji",
          "required" : true,
          "schema" : {
            "$ref" : "#/components/schemas/ReferenceNumber"
          }
        }
      ],
      "requestBody" : {
        "description" : "Dane faktury",
        "content" : {
          "application/json" : {
            "schema" : {
              "required" : [
                "invoiceHash",
                "invoiceSize",
                "encryptedInvoiceHash",
                "encryptedInvoiceSize",
                "encryptedInvoiceContent"
              ],
              "allOf" : [
                {
                  "$ref" : "#/components/schemas/SendInvoiceRequest"
                }
              ]
            },
            "example" : {
              "invoiceHash" : "EbrK4cOSjW4hEpJaHU71YXSOZZmqP5++dK9nLgTzgV4=",
              "invoiceSize" : 6480,
              "encryptedInvoiceHash" : "miYb1z3Ljw5VucTZslv3Tlt+V/EK1V8Q8evD8HMQ0dc=",
              "encryptedInvoiceSize" : 6496,
              "encryptedInvoiceContent" : "...",
              "offlineMode" : false
            }
          }
        }
      },
      "responses" : {
        "202" : {
          "description" : "Accepted",
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/SendInvoiceResponse"
              },
              "example" : {
                "referenceNumber" : "20250625-EE-319D7EE000-B67F415CDC-2C"
              }
            }
          }
        },
        "400" : {
          "description" : "| ExceptionCode       | ExceptionDescription                                | Details                                                                                                    | \n|---------------------|-----------------------------------------------------|------------------------------------------------------------------------------------------------------------|\n| 21173               | Brak sesji o wskazanym numerze referencyjnym.       | Sesja o numerze referencyjnym {referenceNumber} nie została odnaleziona.                                   |\n| 21155               | Przekroczono dozwoloną liczbę faktur w sesji.       | Sesja o numerze referencyjnym {referenceNumber} osiągnęła dozwolony limit liczby faktur {invoiceLimit}.    |\n| 21180               | Status sesji nie pozwala na wykonanie operacji.     | Status sesji {code} uniemożliwia wysyłkę faktur.                                        |\n| 21405 | Błąd walidacji danych wejściowych. | {treść błędu z walidatora} |",
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/ExceptionResponse"
              }
            }
          },
          "x-summary" : "Bad Request"
        },
        "403" : {
          "description" : "Forbidden"
        },
        "401" : {
          "description" : "Unauthorized"
        }
      },
      "security" : [
        {
          "Bearer" : [

          ]
        }
      ],
      "x-required-permissions" : [
        "InvoiceWrite",
        "PefInvoiceWrite"
      ]
    }
  }


  "ReferenceNumber" : {
    "maxLength" : 36,
    "minLength" : 36,
    "type" : "string",
    "description" : "Numer referencyjny."
  }


  "SendInvoiceRequest" : {
    "required" : [
      "encryptedInvoiceContent",
      "encryptedInvoiceHash",
      "encryptedInvoiceSize",
      "invoiceHash",
      "invoiceSize"
    ],
    "type" : "object",
    "properties" : {
      "invoiceHash" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/Sha256HashBase64"
          }
        ],
        "description" : "Skrót SHA256 oryginalnej faktury, zakodowany w formacie Base64."
      },
      "invoiceSize" : {
        "minimum" : 1,
        "exclusiveMinimum" : false,
        "type" : "integer",
        "description" : "Rozmiar oryginalnej faktury w bajtach. Maksymalny rozmiar zależy od limitów ustawionych dla uwierzytelnionego kontekstu.",
        "format" : "int64"
      },
      "encryptedInvoiceHash" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/Sha256HashBase64"
          }
        ],
        "description" : "Skrót SHA256 zaszyfrowanej faktury, zakodowany w formacie Base64."
      },
      "encryptedInvoiceSize" : {
        "minimum" : 1,
        "exclusiveMinimum" : false,
        "type" : "integer",
        "description" : "Rozmiar zaszyfrowanej faktury w bajtach.",
        "format" : "int64"
      },
      "encryptedInvoiceContent" : {
        "type" : "string",
        "description" : "Faktura zaszyfrowana algorytmem AES-256-CBC z dopełnianiem PKCS#7 (kluczem przekazanym przy otwarciu sesji), zakodowana w formacie Base64.",
        "format" : "byte"
      },
      "offlineMode" : {
        "type" : "boolean",
        "description" : "Określa, czy podatnik deklaruje tryb fakturowania \"offline\" dla przesyłanego dokumentu.",
        "default" : false
      },
      "hashOfCorrectedInvoice" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/Sha256HashBase64"
          }
        ],
        "description" : "Skrót SHA256 korygowanej faktury, zakodowany w formacie Base64. Wymagany przy wysyłaniu korekty technicznej faktury.",
        "nullable" : true
      }
    },
    "additionalProperties" : false
  }


  "Sha256HashBase64" : {
    "maxLength" : 44,
    "minLength" : 44,
    "type" : "string",
    "description" : "SHA-256 w Base64.",
    "format" : "byte"
  }


  "Sha256HashBase64" : {
    "maxLength" : 44,
    "minLength" : 44,
    "type" : "string",
    "description" : "SHA-256 w Base64.",
    "format" : "byte"
  }


  "Sha256HashBase64" : {
    "maxLength" : 44,
    "minLength" : 44,
    "type" : "string",
    "description" : "SHA-256 w Base64.",
    "format" : "byte"
  }


  "SendInvoiceResponse" : {
    "required" : [
      "referenceNumber"
    ],
    "type" : "object",
    "properties" : {
      "referenceNumber" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/ReferenceNumber"
          }
        ],
        "description" : "Numer referencyjny faktury."
      }
    },
    "additionalProperties" : false
  }


  "ReferenceNumber" : {
    "maxLength" : 36,
    "minLength" : 36,
    "type" : "string",
    "description" : "Numer referencyjny."
  }



//---------------------------------------------------------------------------------------------------
request: "/api/v2/sessions/online/{referenceNumber}/invoices": post: application/json
headers:
Authorization: Bearer {securityToken}
body:
{
  "invoiceHash": "", // required; type: string; items: #/components/schemas/Sha256HashBase64; description: Skrót SHA256 oryginalnej faktury, zakodowany w formacie Base64.
  "invoiceSize": 0, // required; type: integer; format: int64; description: Rozmiar oryginalnej faktury w bajtach. Maksymalny rozmiar zależy od limitów ustawionych dla uwierzytelnionego kontekstu.
  "encryptedInvoiceHash": "", // required; type: string; items: #/components/schemas/Sha256HashBase64; description: Skrót SHA256 zaszyfrowanej faktury, zakodowany w formacie Base64.
  "encryptedInvoiceSize": 0, // required; type: integer; format: int64; description: Rozmiar zaszyfrowanej faktury w bajtach.
  "encryptedInvoiceContent": "", // required; type: string; format: byte; description: Faktura zaszyfrowana algorytmem AES-256-CBC z dopełnianiem PKCS#7 (kluczem przekazanym przy otwarciu sesji), zakodowana w formacie Base64.
  "offlineMode": true/false, // type: boolean; description: Określa, czy podatnik deklaruje tryb fakturowania "offline" dla przesyłanego dokumentu.
  "hashOfCorrectedInvoice": "" // type: string; items: #/components/schemas/Sha256HashBase64; description: Skrót SHA256 korygowanej faktury, zakodowany w formacie Base64. Wymagany przy wysyłaniu korekty technicznej faktury.
}



response (202): application/json
{
  "referenceNumber": "" // required; type: string; items: #/components/schemas/ReferenceNumber; description: Numer referencyjny faktury.
}
