//
// Endpoint: /api/v2/invoices/exports
//
// Generated by OpenAPI_JSON_To_Single_Endpoint app.
// Author: Grzegorz Molenda.
// (C) 2025, All rights reserved.
// Released under MIT License.
//
  "/api/v2/invoices/exports" : {
    "post" : {
      "tags" : [
        "Pobieranie faktur"
      ],
      "summary" : "Eksport paczki faktur",
      "description" : "Rozpoczyna asynchroniczny proces wyszukiwania faktur w systemie KSeF na podstawie przekazanych filtrów oraz przygotowania ich w formie zaszyfrowanej paczki.\nWymagane jest przekazanie informacji o szyfrowaniu w polu <b>Encryption</b>, które służą do zabezpieczenia przygotowanej paczki z fakturami.\n            \nSystem pobiera faktury rosnąco według daty określonej w filtrze (Invoicing, Issue, PermanentStorage) i dodaje je do paczki aż do osiągnięcia jednego z poniższych limitów:\n* Limit liczby faktur: 10 000 sztuk\n* Limit rozmiaru danych(skompresowanych): 1GB\n\nPaczka eksportu może zawierać dodatkowy plik z metadanymi faktur w formacie JSON (`_metadata.json`). Zawartość pliku to\nobiekt z tablicą <b>invoices</b>, gdzie każdy element jest obiektem typu <b>InvoiceMetadata</b>\n(taki jak zwracany przez endpoint `POST /invoices/query/metadata`).\n\n<b>Plik z metadanymi(_metadata.json) nie jest wliczany do limitów algorytmu budowania paczki</b>. \n\n<b>Tryb preview (włączany nagłówkiem):</b> aby dołączyć plik metadanych w wersji zapoznawczej,\ndodaj do nagłówka żądania: `X-KSeF-Feature: include-metadata`.\nW tym trybie do paczki zostanie dodany plik o nazwie `_metadata.json`.\n\n<b>Domyślne zachowanie od 2025-10-27:</b> od tego dnia paczka eksportu <u>zawsze</u> będzie zawierać plik\n`_metadata.json` z metadanymi, a nagłówek `X-KSeF-Feature` nie będzie wymagany.\n\n`Do realizacji pobierania przyrostowego należy stosować filtrowanie po dacie PermanentStorage`.\n\nWymagane uprawnienia: `InvoiceRead`.",
      "requestBody" : {
        "description" : "Dane wejściowe określające kryteria i format eksportu paczki faktur.",
        "content" : {
          "application/json" : {
            "schema" : {
              "required" : [
                "encryption",
                "filters"
              ],
              "allOf" : [
                {
                  "$ref" : "#/components/schemas/InvoiceExportRequest"
                }
              ]
            },
            "example" : {
              "encryption" : {
                "encryptedSymmetricKey" : "Rk1Qb1VhVjMyQ3NxQ1h1WlVtZUdHcDJSZ0pTbE5IbWQ=",
                "initializationVector" : "c29tZUluaXRWZWN0b3I="
              },
              "filters" : {
                "subjectType" : "Subject1",
                "dateRange" : {
                  "dateType" : "Issue",
                  "from" : "2025-08-28T09:22:13.388+00:00",
                  "to" : "2025-09-28T09:22:13.388+00:00"
                }
              }
            }
          }
        }
      },
      "responses" : {
        "201" : {
          "description" : "Created",
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/ExportInvoicesResponse"
              },
              "example" : {
                "referenceNumber" : "20251010-EH-1B6C9EB000-4B15D3AEB9-89"
              }
            }
          }
        },
        "400" : {
          "description" : "| ExceptionCode       | ExceptionDescription                                | Details                                                       | \n|---------------------|-----------------------------------------------------|---------------------------------------------------------------|\n| 21181               | Nieprawidłowe żądanie eksportu faktur.              | Nie można wyeksportować paczki faktur dla wybranego podmiotu ({subjecttype}) i zalogowanego identyfikatoru kontekstu ({type}). |\n| 21405 | Błąd walidacji danych wejściowych. | {treść błędu z walidatora} |",
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/ExceptionResponse"
              }
            }
          },
          "x-summary" : "Bad Request"
        },
        "403" : {
          "description" : "Forbidden"
        },
        "401" : {
          "description" : "Unauthorized"
        }
      },
      "security" : [
        {
          "Bearer" : [

          ]
        }
      ],
      "x-required-permissions" : [
        "InvoiceRead"
      ]
    }
  }


  "InvoiceExportRequest" : {
    "required" : [
      "encryption",
      "filters"
    ],
    "type" : "object",
    "properties" : {
      "encryption" : {
        "required" : [
          "encryptedSymmetricKey",
          "initializationVector"
        ],
        "allOf" : [
          {
            "$ref" : "#/components/schemas/EncryptionInfo"
          }
        ],
        "description" : "Informacje wymagane do zaszyfrowania wyniku zapytania."
      },
      "filters" : {
        "required" : [
          "subjectType",
          "dateRange"
        ],
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQueryFilters"
          }
        ],
        "description" : "Zestaw filtrów do wyszukiwania faktur."
      }
    },
    "additionalProperties" : false
  }


  "EncryptionInfo" : {
    "required" : [
      "encryptedSymmetricKey",
      "initializationVector"
    ],
    "type" : "object",
    "properties" : {
      "encryptedSymmetricKey" : {
        "type" : "string",
        "description" : "Klucz symetryczny o długości 32 bajtów, zaszyfrowany algorytmem RSA (Padding: OAEP z SHA-256), zakodowany w formacie Base64.\n\n[Klucz publiczny Ministersta Finansów](/docs/v2/index.html#tag/Certyfikaty-klucza-publicznego)"
      },
      "initializationVector" : {
        "type" : "string",
        "description" : "Wektor inicjalizujący (IV) o długości 16 bajtów, używany do szyfrowania symetrycznego, zakodowany w formacie Base64."
      }
    },
    "additionalProperties" : false
  }


  "InvoiceQueryFilters" : {
    "required" : [
      "dateRange",
      "subjectType"
    ],
    "type" : "object",
    "properties" : {
      "subjectType" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQuerySubjectType"
          }
        ],
        "description" : "Typ podmiotu, którego dotyczą kryteria filtrowania metadanych faktur.\nOkreśla kontekst, w jakim przeszukiwane są dane.\n| Wartość | Opis |\n| --- | --- |\n| Subject1 | Podmiot 1 |\n| Subject2 | Podmiot 2 |\n| Subject3 | Podmiot 3 |\n| SubjectAuthorized | Podmiot upoważniony |\n"
      },
      "dateRange" : {
        "required" : [
          "dateType",
          "from"
        ],
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQueryDateRange"
          }
        ],
        "description" : "Typ i zakres dat, według którego mają być filtrowane faktury. Dozwolony maksymalny okres wynosi 2 lata."
      },
      "ksefNumber" : {
        "type" : "string",
        "description" : "Numer KSeF faktury.",
        "nullable" : true
      },
      "invoiceNumber" : {
        "type" : "string",
        "description" : "Numer faktury nadany przez wystawcę.",
        "nullable" : true
      },
      "amount" : {
        "required" : [
          "type"
        ],
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQueryAmount"
          }
        ],
        "description" : "Filtr kwotowy – brutto, netto lub VAT (z wartością).",
        "nullable" : true
      },
      "sellerNip" : {
        "type" : "string",
        "description" : "Nip sprzedawcy.",
        "nullable" : true
      },
      "buyerIdentifier" : {
        "required" : [
          "type"
        ],
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQueryBuyerIdentifier"
          }
        ],
        "description" : "Identyfikator nabywcy.",
        "nullable" : true
      },
      "currencyCodes" : {
        "type" : "array",
        "items" : {
          "$ref" : "#/components/schemas/CurrencyCode"
        },
        "description" : "Kody walut.",
        "nullable" : true
      },
      "invoicingMode" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoicingMode"
          }
        ],
        "description" : "Tryb wystawienia faktury: online lub offline.",
        "nullable" : true
      },
      "isSelfInvoicing" : {
        "type" : "boolean",
        "description" : "Czy faktura została wystawiona w trybie samofakturowania.",
        "nullable" : true
      },
      "formType" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQueryFormType"
          }
        ],
        "description" : "Typ dokumentu.\n| Wartość | Opis |\n| --- | --- |\n| FA | Faktura VAT |\n| PEF | Faktura PEF |\n| RR | Faktura RR |\n",
        "nullable" : true
      },
      "invoiceTypes" : {
        "type" : "array",
        "items" : {
          "$ref" : "#/components/schemas/InvoiceType"
        },
        "description" : "Rodzaje faktur.\n| Wartość | Opis |\n| --- | --- |\n| Vat | (FA) Podstawowa |\n| Zal | (FA) Zaliczkowa |\n| Kor | (FA) Korygująca |\n| Roz | (FA) Rozliczeniowa |\n| Upr | (FA) Uproszczona |\n| KorZal | (FA) Korygująca fakturę zaliczkową |\n| KorRoz | (FA) Korygująca fakturę rozliczeniową |\n| VatPef | (PEF) Podstawowowa |\n| VatPefSp | (PEF) Specjalizowana |\n| KorPef | (PEF) Korygująca |\n| VatRr | (RR) Podstawowa |\n| KorVatRr | (RR) Korygująca |\n",
        "nullable" : true
      },
      "hasAttachment" : {
        "type" : "boolean",
        "description" : "Czy faktura ma załącznik.",
        "nullable" : true
      }
    },
    "additionalProperties" : false
  }


  "InvoiceQuerySubjectType" : {
    "enum" : [
      "Subject1",
      "Subject2",
      "Subject3",
      "SubjectAuthorized"
    ],
    "type" : "string",
    "description" : "| Wartość | Opis |\n| --- | --- |\n| Subject1 | Podmiot 1 |\n| Subject2 | Podmiot 2 |\n| Subject3 | Podmiot 3 |\n| SubjectAuthorized | Podmiot upoważniony |\n"
  }


  "InvoiceQueryDateRange" : {
    "required" : [
      "dateType",
      "from"
    ],
    "type" : "object",
    "properties" : {
      "dateType" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/InvoiceQueryDateType"
          }
        ],
        "description" : "Typ daty, według której ma być zastosowany zakres.\n| Wartość | Opis |\n| --- | --- |\n| Issue | Data wystawienia faktury. |\n| Invoicing | Data przyjęcia faktury w systemie KSeF (do dalszego przetwarzania). |\n| PermanentStorage | Data trwałego zapisu faktury w repozytorium systemu KSeF. |\n"
      },
      "from" : {
        "type" : "string",
        "description" : "Data początkowa zakresu(UTC).",
        "format" : "date-time"
      },
      "to" : {
        "type" : "string",
        "description" : "Data końcowa zakresu(UTC). Jeśli nie zostanie podana, przyjmowana jest bieżąca data i czas w UTC.",
        "format" : "date-time",
        "nullable" : true
      }
    },
    "additionalProperties" : false
  }


  "InvoiceQueryDateType" : {
    "enum" : [
      "Issue",
      "Invoicing",
      "PermanentStorage"
    ],
    "type" : "string",
    "description" : "| Wartość | Opis |\n| --- | --- |\n| Issue | Data wystawienia faktury. |\n| Invoicing | Data przyjęcia faktury w systemie KSeF (do dalszego przetwarzania). |\n| PermanentStorage | Data trwałego zapisu faktury w repozytorium systemu KSeF. |\n"
  }


  "InvoiceQueryAmount" : {
    "required" : [
      "type"
    ],
    "type" : "object",
    "properties" : {
      "type" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/AmountType"
          }
        ]
      },
      "from" : {
        "type" : "number",
        "format" : "double",
        "nullable" : true
      },
      "to" : {
        "type" : "number",
        "format" : "double",
        "nullable" : true
      }
    },
    "additionalProperties" : false
  }


  "AmountType" : {
    "enum" : [
      "Brutto",
      "Netto",
      "Vat"
    ],
    "type" : "string"
  }


  "InvoiceQueryBuyerIdentifier" : {
    "required" : [
      "type"
    ],
    "type" : "object",
    "properties" : {
      "type" : {
        "allOf" : [
          {
            "$ref" : "#/components/schemas/BuyerIdentifierType"
          }
        ],
        "description" : "Typ identyfikatora nabywcy.\n| Wartość | Opis |\n| --- | --- |\n| None | Brak identyfikatora nabywcy |\n| Other | Inny |\n| Nip | NIP |\n| VatUe | VAT UE |\n"
      },
      "value" : {
        "type" : "string",
        "description" : "Wartość identyfikatora nabywcy.",
        "nullable" : true
      }
    },
    "additionalProperties" : false
  }


  "BuyerIdentifierType" : {
    "enum" : [
      "None",
      "Other",
      "Nip",
      "VatUe"
    ],
    "type" : "string",
    "description" : "| Wartość | Opis |\n| --- | --- |\n| None | Brak identyfikatora nabywcy |\n| Other | Inny |\n| Nip | NIP |\n| VatUe | VAT UE |\n"
  }


  "CurrencyCode" : {
    "enum" : [
      "AED",
      "AFN",
      "ALL",
      "AMD",
      "ANG",
      "AOA",
      "ARS",
      "AUD",
      "AWG",
      "AZN",
      "BAM",
      "BBD",
      "BDT",
      "BGN",
      "BHD",
      "BIF",
      "BMD",
      "BND",
      "BOB",
      "BOV",
      "BRL",
      "BSD",
      "BTN",
      "BWP",
      "BYN",
      "BZD",
      "CAD",
      "CDF",
      "CHE",
      "CHF",
      "CHW",
      "CLF",
      "CLP",
      "CNY",
      "COP",
      "COU",
      "CRC",
      "CUC",
      "CUP",
      "CVE",
      "CZK",
      "DJF",
      "DKK",
      "DOP",
      "DZD",
      "EGP",
      "ERN",
      "ETB",
      "EUR",
      "FJD",
      "FKP",
      "GBP",
      "GEL",
      "GGP",
      "GHS",
      "GIP",
      "GMD",
      "GNF",
      "GTQ",
      "GYD",
      "HKD",
      "HNL",
      "HRK",
      "HTG",
      "HUF",
      "IDR",
      "ILS",
      "IMP",
      "INR",
      "IQD",
      "IRR",
      "ISK",
      "JEP",
      "JMD",
      "JOD",
      "JPY",
      "KES",
      "KGS",
      "KHR",
      "KMF",
      "KPW",
      "KRW",
      "KWD",
      "KYD",
      "KZT",
      "LAK",
      "LBP",
      "LKR",
      "LRD",
      "LSL",
      "LYD",
      "MAD",
      "MDL",
      "MGA",
      "MKD",
      "MMK",
      "MNT",
      "MOP",
      "MRU",
      "MUR",
      "MVR",
      "MWK",
      "MXN",
      "MXV",
      "MYR",
      "MZN",
      "NAD",
      "NGN",
      "NIO",
      "NOK",
      "NPR",
      "NZD",
      "OMR",
      "PAB",
      "PEN",
      "PGK",
      "PHP",
      "PKR",
      "PLN",
      "PYG",
      "QAR",
      "RON",
      "RSD",
      "RUB",
      "RWF",
      "SAR",
      "SBD",
      "SCR",
      "SDG",
      "SEK",
      "SGD",
      "SHP",
      "SLL",
      "SOS",
      "SRD",
      "SSP",
      "STN",
      "SVC",
      "SYP",
      "SZL",
      "THB",
      "TJS",
      "TMT",
      "TND",
      "TOP",
      "TRY",
      "TTD",
      "TWD",
      "TZS",
      "UAH",
      "UGX",
      "USD",
      "USN",
      "UYI",
      "UYU",
      "UYW",
      "UZS",
      "VES",
      "VND",
      "VUV",
      "WST",
      "XAF",
      "XAG",
      "XAU",
      "XBA",
      "XBB",
      "XBC",
      "XBD",
      "XCD",
      "XCG",
      "XDR",
      "XOF",
      "XPD",
      "XPF",
      "XPT",
      "XSU",
      "XUA",
      "XXX",
      "YER",
      "ZAR",
      "ZMW",
      "ZWL"
    ],
    "type" : "string"
  }


  "InvoicingMode" : {
    "enum" : [
      "Online",
      "Offline"
    ],
    "type" : "string"
  }


  "InvoiceQueryFormType" : {
    "enum" : [
      "FA",
      "PEF",
      "RR"
    ],
    "type" : "string",
    "description" : "| Wartość | Opis |\n| --- | --- |\n| FA | Faktura VAT |\n| PEF | Faktura PEF |\n| RR | Faktura RR |\n"
  }


  "InvoiceType" : {
    "enum" : [
      "Vat",
      "Zal",
      "Kor",
      "Roz",
      "Upr",
      "KorZal",
      "KorRoz",
      "VatPef",
      "VatPefSp",
      "KorPef",
      "VatRr",
      "KorVatRr"
    ],
    "type" : "string",
    "description" : "| Wartość | Opis |\n| --- | --- |\n| Vat | (FA) Podstawowa |\n| Zal | (FA) Zaliczkowa |\n| Kor | (FA) Korygująca |\n| Roz | (FA) Rozliczeniowa |\n| Upr | (FA) Uproszczona |\n| KorZal | (FA) Korygująca fakturę zaliczkową |\n| KorRoz | (FA) Korygująca fakturę rozliczeniową |\n| VatPef | (PEF) Podstawowowa |\n| VatPefSp | (PEF) Specjalizowana |\n| KorPef | (PEF) Korygująca |\n| VatRr | (RR) Podstawowa |\n| KorVatRr | (RR) Korygująca |\n"
  }


  "ExportInvoicesResponse" : {
    "required" : [
      "operationReferenceNumber",
      "referenceNumber"
    ],
    "type" : "object",
    "properties" : {
      "operationReferenceNumber" : {
        "type" : "string",
        "description" : "Numer referencyjny operacji.",
        "deprecated" : true
      },
      "referenceNumber" : {
        "type" : "string",
        "description" : "Numer referencyjny operacji eksportu paczki faktur."
      }
    },
    "additionalProperties" : false
  }



//---------------------------------------------------------------------------------------------------
request: "/api/v2/invoices/exports": post: application/json
headers:
Authentication: Bearer {securityToken}
body:
{
  "encryption": { // required; type: object; items: #/components/schemas/EncryptionInfo; description: Informacje wymagane do zaszyfrowania wyniku zapytania.
    "encryptedSymmetricKey": "", // required; type: string; description: Klucz symetryczny o długości 32 bajtów, zaszyfrowany algorytmem RSA (Padding: OAEP z SHA-256), zakodowany w formacie Base64.

[Klucz publiczny Ministersta Finansów](/docs/v2/index.html#tag/Certyfikaty-klucza-publicznego)
    "initializationVector": "" // required; type: string; description: Wektor inicjalizujący (IV) o długości 16 bajtów, używany do szyfrowania symetrycznego, zakodowany w formacie Base64.
  },
  "filters": { // required; type: object; items: #/components/schemas/InvoiceQueryFilters; description: Zestaw filtrów do wyszukiwania faktur.
    "subjectType": "", // required; type: string; items: #/components/schemas/InvoiceQuerySubjectType; description: Typ podmiotu, którego dotyczą kryteria filtrowania metadanych faktur.
Określa kontekst, w jakim przeszukiwane są dane.
| Wartość | Opis |
| --- | --- |
| Subject1 | Podmiot 1 |
| Subject2 | Podmiot 2 |
| Subject3 | Podmiot 3 |
| SubjectAuthorized | Podmiot upoważniony |
    "dateRange": { // required; type: object; items: #/components/schemas/InvoiceQueryDateRange; description: Typ i zakres dat, według którego mają być filtrowane faktury. Dozwolony maksymalny okres wynosi 2 lata.
      "dateType": "", // required; type: string; items: #/components/schemas/InvoiceQueryDateType; description: Typ daty, według której ma być zastosowany zakres.
| Wartość | Opis |
| --- | --- |
| Issue | Data wystawienia faktury. |
| Invoicing | Data przyjęcia faktury w systemie KSeF (do dalszego przetwarzania). |
| PermanentStorage | Data trwałego zapisu faktury w repozytorium systemu KSeF. |
      "from": "", // required; type: string; format: date-time; description: Data początkowa zakresu(UTC).
      "to": "" // type: string; format: date-time; nullable: true; description: Data końcowa zakresu(UTC). Jeśli nie zostanie podana, przyjmowana jest bieżąca data i czas w UTC.
    },
    "ksefNumber": "", // type: string; nullable: true; description: Numer KSeF faktury.
    "invoiceNumber": "", // type: string; nullable: true; description: Numer faktury nadany przez wystawcę.
    "amount": { // type: object; items: #/components/schemas/InvoiceQueryAmount; nullable: true; description: Filtr kwotowy – brutto, netto lub VAT (z wartością).
      "type": "", // required; type: string; items: #/components/schemas/AmountType;
      "from": 0, // type: number; format: double; nullable: true;
      "to": 0 // type: number; format: double; nullable: true;
    },
    "sellerNip": "", // type: string; nullable: true; description: Nip sprzedawcy.
    "buyerIdentifier": { // type: object; items: #/components/schemas/InvoiceQueryBuyerIdentifier; nullable: true; description: Identyfikator nabywcy.
      "type": "", // required; type: string; items: #/components/schemas/BuyerIdentifierType; description: Typ identyfikatora nabywcy.
| Wartość | Opis |
| --- | --- |
| None | Brak identyfikatora nabywcy |
| Other | Inny |
| Nip | NIP |
| VatUe | VAT UE |
      "value": "" // type: string; nullable: true; description: Wartość identyfikatora nabywcy.
    },
    "currencyCodes": [ // type: array; nullable: true; description: Kody walut.
    ],
    "invoicingMode": "", // type: string; items: #/components/schemas/InvoicingMode; description: Tryb wystawienia faktury: online lub offline.
    "isSelfInvoicing": true/false, // type: boolean; nullable: true; description: Czy faktura została wystawiona w trybie samofakturowania.
    "formType": "", // type: string; items: #/components/schemas/InvoiceQueryFormType; description: Typ dokumentu.
| Wartość | Opis |
| --- | --- |
| FA | Faktura VAT |
| PEF | Faktura PEF |
| RR | Faktura RR |
    "invoiceTypes": [ // type: array; nullable: true; description: Rodzaje faktur.
| Wartość | Opis |
| --- | --- |
| Vat | (FA) Podstawowa |
| Zal | (FA) Zaliczkowa |
| Kor | (FA) Korygująca |
| Roz | (FA) Rozliczeniowa |
| Upr | (FA) Uproszczona |
| KorZal | (FA) Korygująca fakturę zaliczkową |
| KorRoz | (FA) Korygująca fakturę rozliczeniową |
| VatPef | (PEF) Podstawowowa |
| VatPefSp | (PEF) Specjalizowana |
| KorPef | (PEF) Korygująca |
| VatRr | (RR) Podstawowa |
| KorVatRr | (RR) Korygująca |
    ],
    "hasAttachment": true/false // type: boolean; nullable: true; description: Czy faktura ma załącznik.
  }
}



response (201): application/json
{
  "operationReferenceNumber": "", // required; type: string; description: Numer referencyjny operacji.
  "referenceNumber": "" // required; type: string; description: Numer referencyjny operacji eksportu paczki faktur.
}
